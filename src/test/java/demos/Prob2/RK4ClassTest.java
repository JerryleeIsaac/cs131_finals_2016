package demos.Prob2;

import static org.junit.Assert.*;

import org.junit.Test;

public class RK4ClassTest {

	Double a = 0d;
    Double b = 18d;
    Double h = 0.25d;
    Double x1 = Math.PI/2d;
    Double y1 = 0d;
    Double [][] rk4Answers = RK4Class.RK4("y", "-(0.16/0.5)*y - (9.81/1.2)*sin(x)", a, b, h, x1, y1);

	@Test
	public void testCheckInitialVal() {
		assertEquals(a,rk4Answers[0][0]);
		assertEquals(b,rk4Answers[0][72]);
		assertEquals(x1,rk4Answers[1][0]);
		assertEquals(y1,rk4Answers[2][0]);
	}
	
	@Test
	public void testStepSize() {
		assertEquals(rk4Answers[0][5]-rk4Answers[0][4], 0.25, 0.01);
	}
	
	@Test
	public void testAnswers() {
		Double[] expectedX = {
				1.5707963267948966, 1.3226975904251652, 0.6330709124482451, -0.2666448061322857, -0.9801022286568107,
				-1.2499129085802907, -1.0406068370455157, -0.44030086754695963, 0.30555854761634693, 0.8576884743361466, 
				1.0112492209871546, 0.7476164692166682, 0.18702902186623271, -0.41439316635642054, -0.783885838654141, 
				-0.7907499679666935, -0.4604117862913924, 0.04998358844580092, 0.497761363687645, 0.6880210338540407, 
				0.5630589710610043, 0.19740375582053749, -0.23041424093683777, -0.5191442610887442, -0.5522540042363205, 
				-0.33560373729154913, 0.017699418696989933, 0.33531164565320204, 0.47447486939648376, 0.3877838906445936, 
				0.1305987763853842, -0.167163764001575, -0.3642311372485806, -0.378814179048439, -0.2185736512828861, 
				0.03048412260918082, 0.24596094845653585, 0.3307246311799057, 0.2564309366957444, 0.06912950063112552, 
				-0.13584128999837478, -0.261574852348136, -0.2562643444384238, -0.1325165179751202, 0.043387579616388866, 
				0.18533847352976396, 0.2299410894479862, 0.1641962310558912, 0.027030192830809457, -0.11210105423568262, 
				-0.18805578849008997, -0.17047783700505048, -0.0747763754321924, 0.04843645291551833, 0.13940924910477306, 
				0.15821107785246347, 0.10171737100468106, 0.0020740609491330247, -0.0907877729858664, -0.13397181559010546, 
				-0.11121032780471368, -0.038234798111425675, 0.04695754053693871, 0.10354576251285999, 0.10731267372020528, 
				0.060609247646299026, -0.010824619573752671, -0.07163323962384219, -0.09419028913069259, -0.07093244807147098, 
				-0.01628956639171674, 0.04172931682472126, 0.07569829152804688	
		};
		
		for (int i = 0; i < expectedX.length; i++)
			assertEquals(rk4Answers[1][i], expectedX[i], 0.00000000001);
		
		
		Double[] expectedY = {
				0.0, -1.9486156561248655, -3.421850802909395, -3.494565092858772, -2.0463691930433754,
				-0.09857645703814932, 1.7196562446229524, 2.9210301859799848, 2.8096957518044197, 1.4766034610694836, 
				-0.25449349072373817, -1.77749356652928, -2.533543467641026, -2.0921821155436633, -0.7830192546775787, 
				0.7083827843431509, 1.8299046187095824, 2.087585421175133, 1.365829282666748, 0.12280160769559312, 
				-1.0714674167804026, -1.7329457755455495, -1.55374401948046, -0.681736140734467, 0.40979116043574393, 
				1.2465623794349037, 1.4630564032305633, 0.9835988401558851, 0.10136514834807764, -0.7559259037583808, 
				-1.2133210294901873, -1.074124025502339, -0.45007446874740775, 0.3258550817441065, 0.8970987327936422, 
				1.0127669241028636, 0.6472405311052258, 0.014187521524408941, -0.5760501792556247, -0.8576226404314531, 
				-0.7175987004781926, -0.2553035079357458, 0.28758826336090687, 0.6569186813323677, 0.6924523492385554, 
				0.40174655712863255, -0.052032002086188356, -0.44663567934178794, -0.6036533196565914, -0.46623599265347815, 
				-0.12232247871830476, 0.2513878506401813, 0.47959947828557203, 0.466124366856851, 0.2357525730673062, 
				-0.08630941621611518, -0.343274674676847, -0.42017738862434534, -0.29444205691035186, -0.041040661204108486, 
				0.2117453805976608, 0.34616971626332504, 0.3081725930483049, 0.1289611896778634, -0.09646972407914564, 
				-0.25937631757257007, -0.2883278401754609, -0.18003294557901844, 0.003991240108905003, 0.17183690357652442, 
				0.24630317188207929, 0.19965528487091408, 0.06319678852050756
		};

		for (int i = 0; i < expectedY.length; i++)
			assertEquals(rk4Answers[2][i], expectedY[i], 0.00000000001);

	}

}
